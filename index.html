<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>A History of Deportation Test Map - </title>
    <!--Style Libraries-->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="lib/leaflet.css">
    <!--Javascript Libraries-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.0.0/d3.min.js" integrity="sha512-0x7/VCkKLLt4wnkFqI8Cgv6no+AaS1TDgmHLOoU3hy/WVtYta2J6gnOIHhYYDJlDxPqEqAYLPS4gzVex4mGJLw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!--Data Loads-->
    <script type="text/javascript" src="data/data_new.js"></script>
    <script type="text/javascript" src="data/reg3.js"></script>
    <script type="text/javascript" src="data/reg2.js"></script>
    <script src="js/src.js"></script>
</head>

<body>
    <h1>A History of US Deportation</h1>
    <div id="map"></div>
        <div class="center">
            <!--<input type="button" value="setData" class="btn" onclick="setData()"> -->
            <!-- <input type="button" value="hide" class="btn" onclick="hide()">
            <input type="button" value="show" class="btn" onclick="show()"> -->
            <p class="yr">1993</p>
            <input type="button" value="Pause" class="btn" onclick="pause()" />
            <input type="button" value="Play" class="btn" onclick="play()" />
            <!--<input type="button" value="destroy" class="btn" onclick="destroy()"> -->    
        </div>
    <script src="lib/leaflet.js"></script>
    <script src="js/src.js"></script>
    <!-- <script type="text/javascript" src="js/data_config.js"></script> -->
    <script type="text/javascript" src="js/data_new.js"></script>
    <script>
        var lrmap = L.map('map', {zoomControl: false}).setView([0, 10], 3);
		L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
	        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	        subdomains: 'abcd',
	        maxZoom: 5,
	        minZoom: 3,
            })
            .addTo(lrmap);
        //var data = [{"from":[-95.712891,37.090240],"to":[-102.552788,23.634501],"labels":["United States","Mexico"],"color":"#ff3a31", "value":27118},{"from":[-95.712891,37.090240],"to":[-106.346771,56.130367],"labels":[null,"Canada"],"color":"#ff7e2b","value":1267},{"from":[-95.712891,37.090240],"to":[-88.896530,13.794185],"labels":[null,"El Salvador"],"color":"#ffc726","value":2117},{"from":[-95.712891,37.090240],"to":[-3.435973,55.378052],"labels":[null,"United Kingdom"],"color":"#e9ff20", "value":248},{"from":[-95.712891,37.090240],"to":[-77.32573,18.15246],"labels":[null,"Jamaica"],"color":"#d77681", "value":1044}];
        //var data2=[{"from":[-73.875523,40.781063],"to":[-80.247887,25.792296],"labels":["New York","Miami"],"color":"#d7768a"},{"from":[-73.875523,40.781063],"to":[-118.2705,33.9984],"labels":[null,"Los Angeles"],"color":"#00ccff"},{"from":[-73.875523,40.781063],"to":[-87.724088,41.917846],"labels":[null,"Chicago"],"color":"#ffc726"},{"from":[-73.875523,40.781063],"to":[-71.058437,42.35902],"labels":[null,"Boston"],"color":"#e9ff20"},{"from":[-73.875523,40.781063],"to":[-75.683057,45.42172],"labels":[null,"Ottawa"],"color":"#99ff1b"}];
        //data_im = data_im.map(item => { return {...item, value: parseInt(Math.random()*20)}});
        var migrationLayer = new L.migrationLayer({
            map: lrmap,
            data: data_im, //swap with data_im to see by country versus by continent
            pulseRadius:30,
            pulseBorderWidth:2,
            arcWidth:.5,
            arcLabel:false,
            arcLabelFont:'10px sans-serif',
            maxWidth:10
            }
        );
        migrationLayer.addTo(lrmap);
        //function setData(){
        //    migrationLayer.setData(data2);
        //}
        //function hide(){
        //    migrationLayer.hide();
        //}
        //function show(){
        //    migrationLayer.show();
        //}
        function play(){
            migrationLayer.play();
        }
        function pause(){
            migrationLayer.pause();
        }
        //function destroy() {
        //    migrationLayer.destroy();
        //}
        var popup = L.popup();

        function onMapClick (e) {
            popup  
                .setContent("Deportations " + data_im.value)
                .openOn(lrmap);
        }

        lrmap.on('click', onMapClick);

        // lrmap.on('click', function (e) {
        //     document.getElementsByClassName('coordinate')[0].innerHTML = 'lat: ' + e.latlng.lat + 'lng: ' + e.latlng.lng;
        //     console.log('lat: ' + e.latlng.lat, 'lng: ' + e.latlng.lng)
        // });
    </script>
    <!--Leaderboard-->
    <div class="container">
		<div class= "topright">
            <p class="top5"><span>Top 5</span></p>
            <div id="leaderboard" class="cellit">
                <script type="text/javascript" src="js/global.js"></script>
                <script type="text/javascript" src="js/leaderboard.js"></script>
            </div>
        </div>
    </div>
    <!--Multi-Line Chart-->
    <div class="container">
            <div class="bottomleft" style="height:20%">
                <canvas id="chart" height="100%"></canvas>
            </div>
    </div>
    
    <script>
    //Test load for regional data with years 1993 - 2018 from reg2.js
    console.log(reg); //Confirmed Woo!!!
    //Multi-Line Chart using Chart.js
    const ctx = document.getElementById('chart').getContext('2d');
    const xlabels = reg[0].dates;
    const myChart = new Chart (ctx, {
        type: 'line',
        data: {
            labels: reg[0].dates,//['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
            datasets: [{
                label: reg[0].series[0].labels,
                data: reg[0].series[0].values, //[12, 19, 3, 5, 2, 3],
                fill: false,
                borderColor: reg[0].series[0].color,
                borderwidth: 0
                },
                {
                label: reg[0].series[1].labels,
                data: reg[0].series[1].values,
                fill: false,
                borderColor: reg[0].series[1].color,
                },
                {
                label: reg[0].series[2].labels,
                data: reg[0].series[2].values,
                fill: false,
                borderColor: reg[0].series[2].color,
                },
                {
                label: reg[0].series[3].labels,
                data: reg[0].series[3].values,
                fill: false,
                borderColor: reg[0].series[3].color,
                },
                {
                label: reg[0].series[4].labels,
                data: reg[0].series[4].values,
                fill: false,
                borderColor: reg[0].series[4].color,
                },
                {
                label: reg[0].series[5].labels,
                data: reg[0].series[5].values,
                fill: false,
                borderColor: reg[0].series[5].color,
                }
                ]
                    },
                    options: {
                        scales: {
                                 yAxes: [{
                                     ticks: {
                                         beginAtZero: true
                                     }
                                 }]
                             }

                        },
                        legend: {
                             display: false
                         }
                     });
 
    </script>
  </body>
</html>